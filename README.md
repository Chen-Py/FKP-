# 快速秘钥协定系统（FKP）
## 原理:Diffie-Hellman秘钥交换算法

## 名词介绍

### 人物与机构

**Bob** 发件人

**Alice** 接受人

**Eve** 想要获得秘钥的窃听者

**Libra** 一个认证公开平台，所有人可以利用该平台发布信息，该平台会认证信息并将发送人与信息公布(类似公钥簿)

### 数学名词

**秘钥/钥匙** 不加特殊说明，指对称加密算法的钥匙

**明码** 可以公开的计算秘钥的信息

**个人明码** 一个整数或矩阵、该整数或矩阵乘暗码次幂对一个整数取余、取余数这三个数构成明码，个人明码可以发布到认证公开系统公开

**通信明码** 一次通信需要一个，发件人通过收件人的个人明码和自己设定通信暗码计算出通信明码并发送给接收人，接收人可以此计算秘钥

**暗码** 一个任意选取的数，需要保密

**个人暗码** 每人有一个，用于接收信息时计算秘钥

**通信暗码** 一次通话需要一个，用于发件人计算秘钥和通信明码

## 过程简单介绍

Bob通过公开平台Libra公布的Alice的个人明码与自己随意设定的通信暗码计算出秘钥与通信明码，用秘钥加密信息后将通信明码与密文一起发送给Alice;Alice可以计算出秘钥并解密信息，而中间窃听者Eve无法得知秘钥

## 过程详细介绍(以传送数字为例)

### 个人明码准备

**Step1** Alice随意选取三个数:N,p,M，计算P=(N^p)modM

**Step2** Alice将N,P,M作为明码发送到Libra进行认证与公开或者印在名片上等，将p作为自己的暗码保密

### 发送信息

**Step1** Bob从Libra上获取Alice的明码

**Step2** Bob自行任意设定一个数字q作为通信暗码，计算Q=(N^q)modM作为通信明码，计算K=(P^q)modM作为秘钥

**Step3** Bob用秘钥加密信息获得密文，并将通信明码Q与密文发送给Alice，将通信暗码q保密或销毁

### 接收信息

**Step1** Alice接收Bob发来的信息，得到通信明码Q和密文

**Step2** Alice计算K=(Q^p)modM得到与Bob相同的秘钥

**Step3** Alice使用秘钥将密文解密得到明文

### 拦截信息

**Step1** Eve通过各种渠道获得所有明码(N,P,Q,M)和密文

**Step2** Eve试图计算秘钥，但因缺少暗码(p或q)，且模算术下求对数很困难，故无法计算秘钥

**Step3** Eve气急败坏，但无可奈何

## 算法优缺点

### 算法优点

1.同传统秘钥分发方案相比，该算法可以远程操作，即使操作信息被窃听也无妨，避免了分发秘钥的高成本和高风险

2.同Diffie-Hellman算法相比，该算法中的发件人可以通过收件人公开的个人明码直接发送信息而不需要原算法所必须的两次信息交换，简单来说，原算法两人之间至少需要在线传递4次信息才能协定秘钥并发送密文，而本算法只需要发件人离线发送1次信息即可完成秘钥协定与密文发送

3.本算法是离线算法，不需要两人同时在线交换秘钥，更方便且节省时间

### 算法缺点

1.个人明码重复使用，一旦个人暗码被攻破则会波及历史及以后的所有信息
